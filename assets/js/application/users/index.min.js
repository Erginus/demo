$.blockUI.defaults.message='<img alt="Processing..." src="'+base_url+'assets/images/ajax-loading.gif" />';$.blockUI.defaults.css.border="none";$.blockUI.defaults.css.backgroundColor="none";$.blockUI.defaults.overlayCSS.opacity=.1;$.blockUI.defaults.fadeOut=100;
$(function(){$("#users_datatable").dataTable({sDom:'<"toolbar col-md-3"><"col-md-3"l><"col-md-3"f><"col-md-3 text-right"T>rtip',bSort:!1,aoColumnDefs:[{aTargets:[6],bSearchable:!1,mRender:function(b,c,a){switch(b){case "-1":return'<span id="user_status_'+a[0]+'" class="label label-danger">Suspended</span>';case "0":return'<span id="user_status_'+a[0]+'" class="label label-info">New</span>';case "1":return'<span id="user_status_'+a[0]+'" class="label label-success">Active</span>';default:return'<span id="user_status_'+
a[0]+'" class="label label-info">New</span>'}}},{aTargets:[7],sType:"date",bSearchable:!1,mRender:function(b,c,a){b=b.split(" ")[0].split("-");return b[2]+"-"+b[1]+"-"+b[0]}},{aTargets:[8],bSearchable:!1,mData:null,mRender:function(b,c,a){return'<a class="" href="'+base_url+"acl/user/"+a[0]+'"><i class="fa fa-unlock-alt"></i></a>'}},{aTargets:[9],bSearchable:!1,mData:null,mRender:function(b,c,a){return'<a class="" href="javascript:;" onclick="change_password(\''+a[0]+"','"+a[2]+" "+a[3]+'\');"><i class="fa fa-key"></i></a>'}},
{aTargets:[10],bSearchable:!1,mData:null,mRender:function(b,c,a){return'<a class="" href="'+base_url+"users/edit/"+a[0]+'"><i class="fa fa-pencil"></i></a>'}},{aTargets:[11],bSearchable:!1,mData:null,mRender:function(b,c,a){return'<a class="" href="javascript:;" onclick="delete_user(\''+a[0]+"','"+a[2]+" "+a[3]+'\');"><i class="fa fa-times"></i></a>'}}],fnRowCallback:function(b,c,a,d){$("td:eq(8),td:eq(9),td:eq(10),td:eq(11)",b).addClass("text-center")},oTableTools:{sSwfPath:base_url+"assets/js/plugins/datatables-1.9.4/tabletools-2.2.0/swf/copy_csv_xls_pdf.swf",
aButtons:[{sExtends:"xls",sButtonText:"<i class='fa fa-save'></i> EXCEL",mColumns:[0,1,2,3,4,5,6,7,8]},{sExtends:"pdf",sButtonText:"<i class='fa fa-save'></i> PDF",sPdfOrientation:"landscape",sPdfSize:"tabloid",mColumns:[0,1,2,3,4,5,6,7,8]}]},oLanguage:{sProcessing:'<img alt="Processing..." src="'+base_url+'assets/images/ajax-loading.gif" />',sInfoFiltered:""},bProcessing:!0,bServerSide:!0,bDeferRender:!0,sPaginationType:"bootstrap",sServerMethod:"POST",sAjaxSource:base_url+"users/datatable",iDisplayLength:10,
aLengthMenu:[[20,50,100,200,500,1E3,-1],[20,50,100,200,500,1E3,"All"]],aaSorting:[[0,"asc"]],fnServerParams:function(b){$.each($.ajaxSetup().data,function(c,a){b.push({name:c,value:a})})},fnPreDrawCallback:function(b){$("div.toolbar").html('<a class="btn btn-primary" href="'+base_url+'users/add"><i class="fa fa-plus"></i> Add New User</a>');$(".dataTables_filter label input").addClass("form-control input-sm");$(".dataTables_length label select").css({width:"100px"}).select2()}}).fnSetFilteringDelay(700);
$(document).on("show.bs.modal",function(b){setTimeout(function(){$("input[type=text],input[type=password],textarea").placeholder();$("input[type=radio],input[type=checkbox]").uniform()},0)})});function delete_user(b,c){bootbox.confirm("Do you want to delete : "+c+" ?",function(a){!0===a&&$.post(base_url+"users/delete",{user_id:b},function(a){"1"===a?$("#user_status_"+b).removeAttr("class").addClass("label label-danger").html("Suspended"):bootbox.alert("Error Deleting User : "+c+" !!!")})})}
function change_password(b,c){bootbox.dialog({message:"<form id='new_password_form'><input type='hidden' id='user_id' name='user_id' value='"+b+"' /><div class='form-group'><input class='form-control input-lg' type='password' id='user_login_password' name='user_login_password' placeholder='New Password' value='' /></div><div class='form-group'><input class='form-control input-lg' type='password' id='user_confirm_password' name='user_confirm_password' placeholder='Confirm Password' value='' /></div><div class='form-group'><label class='checkbox-inline'><input type='checkbox' id='notify_user' value='1' name='notify_user'>Send Email to <b>"+
c+"</b> about Account Modifications</label></div></form>",title:"Change Password : "+c,buttons:{cancel:{label:"Cancel",className:"btn-default"},main:{label:"Change Password",className:"btn-primary",callback:function(){$(".modal-content").block();$.post(base_url+"users/change-password",{user_id:$("#user_id").val(),user_login_password:$("#user_login_password").val(),user_confirm_password:$("#user_confirm_password").val(),notify_user:$("#notify_user:checked").val()},function(a){"0"===a?$("#new_password_form").before('<div class="alert alert-danger alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>Error Changing Password !!!</div>'):
"1"===a?($("#new_password_form").before('<div class="alert alert-success alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>Password Changed Successfully !!!</div>'),setTimeout(function(){bootbox.hideAll()},3500)):$("#new_password_form").before('<div class="alert alert-danger alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>'+a+"</div>");$(".modal-content").unblock();$(".alert-danger").is(":visible")&&
setTimeout(function(){$(".alert-danger").fadeOut()},2E3)});return!1}}}})};
